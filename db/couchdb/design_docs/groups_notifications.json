{
  "_id": "_design/groups_notifications",
  "language": "query",
  "views": {
    "unreadNotificationsByGroupAndAttribute": {
      "map": {
        "fields": {
          "data.group": "asc",
          "data.attribute": "asc"
        },
        "partial_filter_selector": {
          "$and": [
            {
              "type": {
                "$eq": "groupUpdate"
              }
            },
            {
              "status": {
                "$eq": "unread"
              }
            }
          ]
        }
      },
      "reduce": "_count",
      "options": {
        "def": {
          "partial_filter_selector": {
            "type": "groupUpdate",
            "status": "unread"
          },
          "fields": [
            "data.group",
            "data.attribute"
          ]
        }
      }
    }
  }
}
